demo()
setwd('/home/dave/school_lab/Courses/STAT854/Assignments/sp/')
library('lpstuff')
source('mt.R')
data_path <- "BFO_data.10s"
N <- 1000
source('Q1.R')
data <- Q1(data_path, N)
source('Q2.R')
R.B <- Q2(data[[2]][1:N])
source('Q3.R')
spec <- Q3(data[[2]][1:N], N, 2048)
str(spec)
pdf("q3_multitaper.pdf")
plot(spec$freq, spec$mt, type='l', log='y',
ylab="Spectrum", xlab="Frequency (Hz)",
main="BMG microbarometer - MT")
dev.off()
pdf("q3_multitaper.pdf")
plot(spec$freq, spec$mt, type='l', log='y',
ylab="Spectrum", xlab="Frequency (Hz)",
main="BMG microbarometer - MT",
sub="NW=6; K=5; M=2048")
dev.off()
str(spec)
pdf("q3_hanMean.pdf")
plot(spec$freq, spec$han_mean, type='l', log='y',
xlab="Frequency (Hz)", ylab="Spectrum",
main="BMG microbarometer - Hanning Sections: Mean",
sub="4 sections (400 points), 50% overlap")
dev.off()
pdf("q3_hanMedian.pdf")
plot(spec$freq, spec$spec.han_med, type='l', log='y',
xlab="Frequency (Hz)", ylab="Spectrum",
main="BMG microbarometer - Hanning Sections: Median",
sub="4 sections - 400 points each; 50% overlap; median of each
frequency bin taken")
dev.off()
plot(spec$freq, spec$spec.han_med, type='l', log='y',
xlab="Frequency (Hz)", ylab="Spectrum",
main="BMG microbarometer - Hanning Sections: Median",
sub="4 sections - 400 points each; 50% overlap; median taken")
pdf("q3_hanMedian.pdf")
plot(spec$freq, spec$han_med, type='l', log='y',
xlab="Frequency (Hz)", ylab="Spectrum",
main="BMG microbarometer - Hanning Sections: Median",
sub="4 sections - 400 points each; 50% overlap; median taken")
dev.off()
pdf("q3_hanExp.pdf")
plot(spec$freq, spec$han_exp, type='l', log='y',
xlab="Frequency (Hz)", ylab="Spectrum",
main="BMG microbarometer - Hanning Sections: Geometric Mean",
sub="4 sections - 400 points each; 50% overlap; geometric mean")
dev.off()
pdf("q3_hanGeoMean.pdf")
plot(spec$freq, spec$han_exp, type='l', log='y',
xlab="Frequency (Hz)", ylab="Spectrum",
main="BMG microbarometer - Hanning Sections: Geometric Mean",
sub="4 sections - 400 points each; 50% overlap; geometric mean taken")
dev.off()
plot(spec$freq, spec$han_mean, type='l', log='y',
xlab="Frequency (Hz)", ylab="Spectrum",
main="BMG microbarometer - Hanning Sectioning Approach")
line(spec$han_med, lty=3)
?line
plot(spec$freq, spec$han_mean, type='l', log='y',
xlab="Frequency (Hz)", ylab="Spectrum",
main="BMG microbarometer - Hanning Sectioning Approach")
lines(spec$han_med, lty=3)
plot(spec$freq, spec$han_med, type='l', log='y')
plot(spec$freq, spec$han_mean, type='l', log='y',
xlab="Frequency (Hz)", ylab="Spectrum",
main="BMG microbarometer - Hanning Sectioning Approach")
lines(spec$han_med)
lines(spec$han_med, col='red', lty=8)
str(spec)
x <- 1:30
plot(sin(x*pi / 20), type='l'
)
lines(x/30)
plot(spec$freq, spec$han_mean, type='l', log='y',
xlab="Frequency (Hz)", ylab="Spectrum",
main="BMG microbarometer - Hanning Sectioning Approach")
lines(spec$han_med, col='red', lty=8)
lines(spec$freq, spec$han_med, col='red', lty=8)
colors()
lines(spec$freq, spec$han_exp, col='blue', lty=6)
?legend
plot(spec$freq, spec$han_mean, type='l', log='y',
xlab="Frequency (Hz)", ylab="Spectrum",
main="BMG microbarometer - Hanning Sectioning Approach")
lines(spec$freq, spec$han_med, col='red')
lines(spec$freq, spec$han_exp, col='blue')
legend("topright", c("Arithmetic Mean", "Median", "Geometric Mean"),
col=c("black", "red", "blue"))
legend("topright", c("Arithmetic Mean", "Median", "Geometric Mean"),
col=c("black", "red", "blue"), lty=c(1,1,1))
pdf("q3_hanningCompare.pdf")
plot(spec$freq, spec$han_mean, type='l', log='y',
xlab="Frequency (Hz)", ylab="Spectrum",
main="BMG microbarometer - Hanning Sectioning Approach")
lines(spec$freq, spec$han_med, col='red')
lines(spec$freq, spec$han_exp, col='blue')
legend("topright", c("Arithmetic Mean", "Median", "Geometric Mean"),
col=c("black", "red", "blue"), lty=c(1,1,1))
dev.off()
pdf("q3_hanningCompare.pdf")
plot(spec$freq, spec$han_mean, type='l', log='y',
xlab="Frequency (Hz)", ylab="Spectrum",
main="BMG microbarometer - Hanning Sectioning Approach")
lines(spec$freq, spec$han_med, col='red', lty=3)
lines(spec$freq, spec$han_exp, col='blue')
legend("topright", c("Arithmetic Mean", "Median", "Geometric Mean"),
col=c("black", "red", "blue"), lty=c(1,3,1))
dev.off()
pdf("q3_hanningCompare.pdf")
plot(spec$freq, spec$han_mean, type='l', log='y',
xlab="Frequency (Hz)", ylab="Spectrum",
main="BMG microbarometer - Hanning Sectioning Approach")
lines(spec$freq, spec$han_med, col='red', lty=1)
lines(spec$freq, spec$han_exp, col='blue', lty=2)
legend("topright", c("Arithmetic Mean", "Median", "Geometric Mean"),
col=c("black", "red", "blue"), lty=c(1,1,2))
dev.off()
pdf("q3_hanningCompare.pdf")
plot(spec$freq, spec$han_mean, type='l', log='y', lwd=2
xlab="Frequency (Hz)", ylab="Spectrum",
main="BMG microbarometer - Hanning Sectioning Approach")
lines(spec$freq, spec$han_med, col='red', lty=1)
lines(spec$freq, spec$han_exp, col='blue', lty=2)
legend("topright", c("Arithmetic Mean", "Median", "Geometric Mean"),
col=c("black", "red", "blue"), lty=c(1,1,2))
pdf("q3_hanningCompare.pdf")
plot(spec$freq, spec$han_mean, type='l', log='y', lwd=2,
xlab="Frequency (Hz)", ylab="Spectrum",
main="BMG microbarometer - Hanning Sectioning Approach")
lines(spec$freq, spec$han_med, col='red', lty=1)
lines(spec$freq, spec$han_exp, col='blue', lty=2)
legend("topright", c("Arithmetic Mean", "Median", "Geometric Mean"),
col=c("black", "red", "blue"), lty=c(1,1,2))
dev.off()
pdf("q3_hanningCompare.pdf")
plot(spec$freq, spec$han_mean, type='l', log='y', lwd=2,
xlab="Frequency (Hz)", ylab="Spectrum",
main="BMG microbarometer - Hanning Sectioning Approach")
lines(spec$freq, spec$han_med, col='red', lty=1)
lines(spec$freq, spec$han_exp, col='blue', lty=2)
legend("topright", c("Arithmetic Mean", "Median", "Geometric Mean"),
col=c("black", "red", "blue"), lty=c(1,1,2), lwd=c(2,1,1))
dev.off()
pdf("q3_hanningCompare.pdf")
plot(spec$freq, spec$han_mean, type='l', log='y', lwd=2,
xlab="Frequency (Hz)", ylab="Spectrum",
main="BMG microbarometer - Hanning Sectioning Approach")
lines(spec$freq, spec$han_med, col='red', lty=1)
lines(spec$freq, spec$han_exp, col='blue', lty=2)
lines(spec$freq, spec$mt, col='darkgreen')
legend("topright", c("Arithmetic Mean", "Median", "Geometric Mean",
"Multitaper"),
col=c("black", "red", "blue", "darkgreen"), lty=c(1,1,2, 1),
lwd=c(2,1,1, 1))
dev.off()
pdf("q3_hanningCompare.pdf")
plot(spec$freq, spec$han_mean, type='l', log='y', lwd=2,
xlab="Frequency (Hz)", ylab="Spectrum",
main="BMG microbarometer - Hanning Sectioning Approach")
lines(spec$freq, spec$han_med, col='red', lty=1)
lines(spec$freq, spec$han_exp, col='blue', lty=2)
lines(spec$freq, spec$mt, col='darkgreen')
legend("topright", c("Arithmetic Mean", "Median", "Geometric Mean",
"Multitaper"),
col=c("black", "red", "blue", "darkgreen"), lty=c(1,1,2, 1),
lwd=c(2,1,1, 1))
dev.off()
source("Q4.R")
s.amt <- Q4(data, N, NW = 10, K = 20 )
source("Q4.R")
s.amt <- Q4(data, N, NW = 10, K = 20 )
str(s.amt)
plot(s.amt$freq, s.amt$data.mt, type='l', log='y',
xlab="Frequency (Hz)", ylab="Spectrum",
main="BMG microbarometer - Multitaper, Adpt Weight",
sub="1000 samples; NW=10; K=20; M=2048")
plot(s.amt$data.mt)
dev.off()
plot(s.amt$freq, s.amt$data.mt, type='l', log='y',
xlab="Frequency (Hz)", ylab="Spectrum",
main="BMG microbarometer - Multitaper, Adpt Weight",
sub="1000 samples; NW=10; K=20; M=2048")
source("Q4.R")
s.amt <- Q4(data, N, NW = 10, K = 20 )
plot(s.amt$freq, s.amt$data.mt, type='l', log='y',
xlab="Frequency (Hz)", ylab="Spectrum",
main="BMG microbarometer - Multitaper, Adpt Weight",
sub="1000 samples; NW=10; K=20; M=2048")
1/20
s.amt$freq
freq <- seq(0, 1/(2*10), 1/(10*M))
M<-2048
freq <- seq(0, 1/(2*10), 1/(10*M))
freq
setwd('/home/dave/school_lab/Courses/STAT854/Assignments/sp/')
library('lpstuff')
source('mt.R')
data_path <- "BFO_data.10s"
N <- 1000
source('Q1.R')
# Returns a list
# - raw data in [[1]], demeaned data in [[2]]
data <- Q1(data_path, N)
# Computes first 200 autocorrelations
source('Q2.R')
R.B <- Q2(data[[2]][1:N])
# Computes a simple multi-taper estimate and
# 3 types of sectioned Hanning spectral estimate.
source('Q3.R')
spec <- Q3(data[[2]][1:N], N, 2048)
source("Q4.R")
s.amt <- Q4(data, N, NW = 10, K = 20 )
s.amt$freq
plot(s.amt$freq, s.amt$data.mt, type='l', log='y',
xlab="Frequency (Hz)", ylab="Spectrum",
main="BMG microbarometer - Multitaper, Adpt Weight",
sub="1000 samples; NW=10; K=20; M=2048")
pdf("q4_multitaper.pdf")
plot(s.amt$freq, s.amt$data.mt, type='l', log='y',
xlab="Frequency (Hz)", ylab="Spectrum",
main="BMG microbarometer - Multitaper, Adpt Weight",
sub="1000 samples; NW=10; K=20; M=2048")
dev.off()
source('Q5.R')
Q5(s.amt$data.mt, data[[2]][1:N])
pdf("q1_data.pdf")
plot(data$raw, type='l', xlab="Time (UNITS)", ylab="Pressure (UNITS)",
main="BMG microbarameter - April 4, 2006 - 0 to 2:46:40 (h:mm:ss)")
dev.off()
pdf("q1_norm.pdf")
qqnorm(data$demean)
qqline(data$demean)
dev.off()
# Question 2
####
pdf("q2_bartlett.pdf")
plot(0:200, R.B, ylab=expression(R[B]), xlab="Lag", type = "h",
main="BMG microbarometer Autocorrelations")
dev.off()
# Question 3
####
pdf("q3_multitaper.pdf")
plot(spec$freq, spec$mt, type='l', log='y',
ylab="Spectrum", xlab="Frequency (Hz)",
main="BMG microbarometer - MT",
sub="NW=6; K=5; M=2048")
dev.off()
pdf("q3_hanMean.pdf")
plot(spec$freq, spec$han_mean, type='l', log='y',
xlab="Frequency (Hz)", ylab="Spectrum",
main="BMG microbarometer - Hanning Sections: Mean",
sub="4 sections - 400 points each; 50% overlap; mean taken")
dev.off()
pdf("q3_hanMedian.pdf")
plot(spec$freq, spec$han_med, type='l', log='y',
xlab="Frequency (Hz)", ylab="Spectrum",
main="BMG microbarometer - Hanning Sections: Median",
sub="4 sections - 400 points each; 50% overlap; median taken")
dev.off()
pdf("q3_hanGeoMean.pdf")
plot(spec$freq, spec$han_exp, type='l', log='y',
xlab="Frequency (Hz)", ylab="Spectrum",
main="BMG microbarometer - Hanning Sections: Geometric Mean",
sub="4 sections - 400 points each; 50% overlap; geometric mean taken")
dev.off()
pdf("q3_hanningCompare.pdf")
plot(spec$freq, spec$han_mean, type='l', log='y', lwd=2,
xlab="Frequency (Hz)", ylab="Spectrum",
main="BMG microbarometer - Hanning Sectioning Approach")
lines(spec$freq, spec$han_med, col='red', lty=1)
lines(spec$freq, spec$han_exp, col='blue', lty=2)
lines(spec$freq, spec$mt, col='darkgreen')
legend("topright", c("Arithmetic Mean", "Median", "Geometric Mean",
"Multitaper"),
col=c("black", "red", "blue", "darkgreen"), lty=c(1,1,2, 1),
lwd=c(2,1,1, 1))
dev.off()
# Question 4
########
pdf("q4_multitaper.pdf")
plot(s.amt$freq, s.amt$data.mt, type='l', log='y',
xlab="Frequency (Hz)", ylab="Spectrum",
main="BMG microbarometer - Multitaper, Adpt Weight",
sub="1000 samples; NW=10; K=20; M=2048")
dev.off()
Q5(s.amt$data.mt, data[[2]][1:N])
1.862286e+08 / 1.867187e+08
source('Q6.R')
R <- Q6(s.amt$data.mt, R.B, N)
source('Q7.R')
y.t <- Q7(data[[2]][1:N], R[[2]], 3)
plot(Q7)
plot(y.t)
plot(y.t, type='l')
