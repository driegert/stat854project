setwd('/home/dave/school_lab/Courses/STAT854/Assignments/sp/')
library('lpstuff')
source('mt.R')
data_path <- "BFO_data.10s"
N <- 1000
source('Q1.R')
# Returns a list
# - raw data in [[1]], demeaned data in [[2]]
data <- Q1(data_path, N)
# Computes first 200 autocorrelations
source('Q2.R')
R.B <- Q2(data[[2]][1:N])
# Computes a simple multi-taper estimate and
# 3 types of sectioned Hanning spectral estimate.
source('Q3.R')
spec <- Q3(data[[2]][1:N], N, 2048)
source("Q4.R")
s.amt <- Q4(data, N, NW = 10, K = 20 )
source('Q5.R')
Q5(s.amt$data.mt, data[[2]][1:N])
source('Q6.R')
R <- Q6(s.amt$data.mt, R.B, N)
# Returns the prewhitened data with N-AR_order points
source('Q7.R')
y.t <- Q7(data[[2]][1:N], R[[2]], 3)
?ts
seq(1, 10, 2)
pdf("q1_data.pdf")
plot(seq(0, 10000, 10), data$raw, type='l', xlab="Time (s)", ylab="Pressure (UNITS)",
main="BMG microbarameter",
sub="April 4, 2006 - 0 to 2:46:40 (h:mm:ss)")
dev.off()
plot(seq(0, 9999, 10), data$raw, type='l', xlab="Time (s)", ylab="Pressure (UNITS)",
main="BMG microbarameter",
sub="April 4, 2006 - 0 to 2:46:40 (h:mm:ss)")
pdf("q1_data.pdf")
plot(seq(0, 9999, 10), data$raw, type='l', xlab="Time (s)", ylab="Pressure (UNITS)",
main="BMG microbarameter",
sub="April 4, 2006 - 0 to 2:46:40 (h:mm:ss)")
dev.off()
plot(seq(0, 10000, 10), y.t, type='l', xlab="Time (s)",
ylab="Prediction Residual",
main="BMG microbarometer - Prediction Residuals")
plot(seq(0, 9999, 10), y.t, type='l', xlab="Time (s)",
ylab="Prediction Residual",
main="BMG microbarometer - Prediction Residuals")
plot(seq(0, length(y.t)-1, 10), y.t, type='l', xlab="Time (s)",
ylab="Prediction Residual",
main="BMG microbarometer - Prediction Residuals")
dev.off()
plot(seq(0, length(y.t)-1, 10), y.t, type='l', xlab="Time (s)",
ylab="Prediction Residual",
main="BMG microbarometer - Prediction Residuals")
length(seq(0, length(y.t)-1, 10))
length(y.t)
plot(seq(0, 10*length(y.t)-1, 10), y.t, type='l', xlab="Time (s)",
ylab="Prediction Residual",
main="BMG microbarometer - Prediction Residuals")
plot(seq(1000-length(y.t), 10*length(y.t)-1, 10), y.t, type='l', xlab="Time (s)",
ylab="Prediction Residual",
main="BMG microbarometer - Prediction Residuals")
dev.off()
plot(seq(1000-length(y.t), 10*length(y.t)-1, 10), y.t, type='l', xlab="Time (s)",
ylab="Prediction Residual",
main="BMG microbarometer - Prediction Residuals")
plot(seq(1000-length(y.t), 10*length(y.t), 10), y.t, type='l', xlab="Time (s)",
ylab="Prediction Residual",
main="BMG microbarometer - Prediction Residuals")
pdf("q7_residuals.pdf")
plot(seq(1000-length(y.t), 10*length(y.t), 10), y.t, type='l', xlab="Time (s)",
ylab="Prediction Residual",
main="BMG microbarometer - AR2 Prediction Residuals")
dev.off()
source('Q8.R')
spec.est <- Q8(y.t$y.t, y.t$phi)
source('Q7.R')
y.t <- Q7(data[[2]][1:N], R[[2]], 3)
source('Q8.R')
spec.est <- Q8(y.t$y.t, y.t$phi)
y.t <- y.t$y.t
N <- length(y.t)
M <- 2^(floor(log2(N)) + 2)
est <- Q4(y.t, N, NW=6, K=10)
source("Q4.R")
s.amt <- Q4(data, N, NW = 10, K = 20 )
setwd('/home/dave/school_lab/Courses/STAT854/Assignments/sp/')
library('lpstuff')
source('mt.R')
data_path <- "BFO_data.10s"
N <- 1000
source('Q1.R')
# Returns a list
# - raw data in [[1]], demeaned data in [[2]]
data <- Q1(data_path, N)
# Computes first 200 autocorrelations
source('Q2.R')
R.B <- Q2(data[[2]][1:N])
# Computes a simple multi-taper estimate and
# 3 types of sectioned Hanning spectral estimate.
source('Q3.R')
spec <- Q3(data[[2]][1:N], N, 2048)
source("Q4.R")
s.amt <- Q4(data, N, NW = 10, K = 20 )
source('Q5.R')
Q5(s.amt$data.mt, data[[2]][1:N])
source('Q6.R')
R <- Q6(s.amt$data.mt, R.B, N)
# Returns the prewhitened data with N-AR_order points
source('Q7.R')
y.t <- Q7(data[[2]][1:N], R[[2]], 3)
source('Q8.R')
spec.est <- Q8(y.t$y.t, y.t$phi)
source('Q8.R')
spec.est <- Q8(y.t$y.t, y.t$phi)
1 - c(1,2,3)
1 / c(1,2,3)
c(1,2) / c(1,2,3)
y.t <- y.t$y.t
N <- length(y.t)
M <- 2^(floor(log2(N)) + 2)
est <- mt( y.t, N = N, NW = 10, K = 20 )
length(est)
length(est$data.mt)
source('Q7.R')
y.t <- Q7(data[[2]][1:N], R[[2]], 3)
phi <- y.t$phi
y.t <- y.t$y.t
N <- length(y.t)
M <- 2^(floor(log2(N)) + 2)
est <- mt( y.t, N = N, NW = 10, K = 20 )
length(est)-length(phi)
spec.x <- est$data.mt / (abs(1 - fft(c(phi, rep(0, length(est$data.mt)-length(phi))))))^2
H <- est / spec.x
list(res.spec=est, data.corr=spec.x, H=H)
setwd('/home/dave/school_lab/Courses/STAT854/Assignments/sp/')
library('lpstuff')
source('mt.R')
data_path <- "BFO_data.10s"
N <- 1000
source('Q1.R')
# Returns a list
# - raw data in [[1]], demeaned data in [[2]]
data <- Q1(data_path, N)
# Computes first 200 autocorrelations
source('Q2.R')
R.B <- Q2(data[[2]][1:N])
# Computes a simple multi-taper estimate and
# 3 types of sectioned Hanning spectral estimate.
source('Q3.R')
spec <- Q3(data[[2]][1:N], N, 2048)
source("Q4.R")
s.amt <- Q4(data, N, NW = 10, K = 20 )
source('Q5.R')
Q5(s.amt$data.mt, data[[2]][1:N])
source('Q6.R')
R <- Q6(s.amt$data.mt, R.B, N)
# Returns the prewhitened data with N-AR_order points
source('Q7.R')
y.t <- Q7(data[[2]][1:N], R[[2]], 3)
source('Q8.R')
spec.est <- Q8(y.t$y.t, y.t$phi)
Q8
plot(seq(0, 1/20, 1/(10*2048)), spec.est$res.spec, type='l',
xlab="Frequency (Hz)", ylab="Spectrum")
plot(spec.est$res.spec, type='l',
xlab="Frequency (Hz)", ylab="Spectrum")
plot(spec.est$res.spec, type='l', log='y'
xlab="Frequency (Hz)", ylab="Spectrum")
plot(spec.est$res.spec, type='l', log='y',
xlab="Frequency (Hz)", ylab="Spectrum")
plot(spec.est$H, type='l')
source('Q8.R')
spec.est <- Q8(y.t$y.t, y.t$phi)
plot(spec.est$H, type='l')
setwd('/home/dave/school_lab/Courses/STAT854/Assignments/sp/')
library('lpstuff')
source('mt.R')
data_path <- "BFO_data.10s"
N <- 1000
source('Q1.R')
# Returns a list
# - raw data in [[1]], demeaned data in [[2]]
data <- Q1(data_path, N)
# Computes first 200 autocorrelations
source('Q2.R')
R.B <- Q2(data[[2]][1:N])
# Computes a simple multi-taper estimate and
# 3 types of sectioned Hanning spectral estimate.
source('Q3.R')
spec <- Q3(data[[2]][1:N], N, 2048)
source("Q4.R")
s.amt <- Q4(data, N, NW = 10, K = 20 )
source('Q5.R')
Q5(s.amt$data.mt, data[[2]][1:N])
source('Q6.R')
R <- Q6(s.amt$data.mt, R.B, N)
# Returns the prewhitened data with N-AR_order points
source('Q7.R')
y.t <- Q7(data[[2]][1:N], R[[2]], 3)
source('Q8.R')
spec.est <- Q8(y.t$y.t, y.t$phi)
plot(spec.est$H, type='l')
plot(spec.est$res.spec, type='l', log='y',
xlab="Frequency (Hz)", ylab="Spectrum")
?complex
